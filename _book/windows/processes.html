
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Review Running Processes Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="network.html" />
    
    
    <link rel="prev" href="autoruns.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../preparations.html">
            
                <a href="../preparations.html">
            
                    
                    Preparations
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../safety.html">
            
                <a href="../safety.html">
            
                    
                    Safety
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../trust.html">
            
                <a href="../trust.html">
            
                    
                    Trust
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../backup.html">
            
                <a href="../backup.html">
            
                    
                    Backup
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../methodology.html">
            
                <a href="../methodology.html">
            
                    
                    Methodology
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../windows.html">
            
                <a href="../windows.html">
            
                    
                    Checking Windows Computers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="autoruns.html">
            
                <a href="autoruns.html">
            
                    
                    Review Programs Launching at Startup
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.4.2" data-path="processes.html">
            
                <a href="processes.html">
            
                    
                    Review Running Processes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="network.html">
            
                <a href="network.html">
            
                    
                    Review Network Connections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="extract.html">
            
                <a href="extract.html">
            
                    
                    Extract Data for Further Analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../mac.html">
            
                <a href="../mac.html">
            
                    
                    Checking Mac Computers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../mac/autoruns.html">
            
                <a href="../mac/autoruns.html">
            
                    
                    Review Programs Launching at Startup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../mac/processes.html">
            
                <a href="../mac/processes.html">
            
                    
                    Review Running Processes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../mac/kernel.html">
            
                <a href="../mac/kernel.html">
            
                    
                    Review Kernel Extensions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../mac/network.html">
            
                <a href="../mac/network.html">
            
                    
                    Review Network Connections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../mac/extract.html">
            
                <a href="../mac/extract.html">
            
                    
                    Extract Data for Further Analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../smartphones.html">
            
                <a href="../smartphones.html">
            
                    
                    Checking Smartphones
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../smartphones/linkeddevices.html">
            
                <a href="../smartphones/linkeddevices.html">
            
                    
                    Check Devices Linked to Chat Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../smartphones/network.html">
            
                <a href="../smartphones/network.html">
            
                    
                    Monitor Network Traffic
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../android.html">
            
                <a href="../android.html">
            
                    
                    Checking Android Devices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../android/applications.html">
            
                <a href="../android/applications.html">
            
                    
                    Review installed Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../android/root.html">
            
                <a href="../android/root.html">
            
                    
                    Check if the Phone is Rooted
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../android/extract.html">
            
                <a href="../android/extract.html">
            
                    
                    Extract Data for Further Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../android/stalkerware.html">
            
                <a href="../android/stalkerware.html">
            
                    
                    Optional : Check for Indicators of Stalkerware Installation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../ios.html">
            
                <a href="../ios.html">
            
                    
                    Checking iOS Devices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../ios/icloud.html">
            
                <a href="../ios/icloud.html">
            
                    
                    Review iCloud Accounts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../ios/mdm.html">
            
                <a href="../ios/mdm.html">
            
                    
                    Check for Mobile Device Management Profiles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../ios/jailbreaks.html">
            
                <a href="../ios/jailbreaks.html">
            
                    
                    Check for Jailbreaks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../ios/extract.html">
            
                <a href="../ios/extract.html">
            
                    
                    Extract Data for Further Analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../remote.html">
            
                <a href="../remote.html">
            
                    
                    Checking Devices Remotely
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../remote/mac.html">
            
                <a href="../remote/mac.html">
            
                    
                    Mac Computers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../license-credits.html">
            
                <a href="../license-credits.html">
            
                    
                    License and Credits
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Review Running Processes</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="review-running-processes">Review Running Processes</h1>
<p>A computer infected with spyware should have some malicious processes running at all times, monitoring the system and collecting data to be transmitted to the <a href="https://securitywithoutborders.org/resources/digital-security-glossary.html#cnc" target="_blank">Command &amp; Control server</a> of the attackers. Therefore, another required step in triaging a suspected Windows computer is to extract the list of running processes and find if any of them display suspicious characteristics.</p>
<p>There are a couple of tools available in order to do this.</p>
<p><strong>Warning:</strong> more sophisticated spyware might be capable of evading this tool by either hiding its own entries from the tree, or by perhaps terminating immediately if they observe any of these tools being launched. In this guide we provide some initial methodology and suggestions to perform an initial assessment. A clean process list is not necessarily a guarantee of a clean system.</p>
<p>Before proceeding with this check, it is advisable that you close all visible running applications, in order to reduce the outputs of the tools you will run to the bare minimum.</p>
<h2 id="process-explorer">Process Explorer</h2>
<p><a href="https://technet.microsoft.com/en-us/sysinternals/processexplorer.aspx" target="_blank">Process Explorer</a> is another tool from the <a href="https://docs.microsoft.com/en-us/sysinternals/downloads/sysinternals-suite" target="_blank">Sysinternals Suite</a> by Microsoft, and it lists all the processes running on the system in a tree:</p>
<p><img src="../img/procexp.png" alt=""></p>
<p>The methodology to check for suspicious running processes is somewhat similar to what we described in the <a href="autoruns.html">Review Programs Launching at Startup</a> section.</p>
<h3 id="1-verify-image-signatures">1. Verify image signatures</h3>
<p>Similarly to Autoruns, Process Explorer also allows to verify signatures of applications running by clicking <em>Options</em> and enabling &quot;<em>Verify Image Signatures</em>&quot;. The same considerations and warnings we described in the <a href="autoruns.html">previous section</a> apply here too. Even more so with running processes, the fact that a process application is signed does not necessarily mean it is safe. Malware often makes use of techniques such as <a href="https://attack.mitre.org/techniques/T1093/" target="_blank">Process Hollowing</a> or <a href="https://attack.mitre.org/techniques/T1073/" target="_blank">DLL Sideloading</a> in order to execute code from inside the context of a legitimate and signed application in order to thwart detection.</p>
<p><img src="../img/procexp2.png" alt=""></p>
<h3 id="2-look-for-scripts">2. Look for Scripts</h3>
<p>Attackers these days often make use of Microsoft Windows scripting capabilities, such as PowerShell and Windows Script Host, because of their flexibility and even ability to evade detection. These scripting engines are commonly used by enterprise customers to automate configurations of internal systems. It is less common to see consumer applications use them, therefore any related processes running should be further inspected.</p>
<p>These processes normally would be called <code>powershell.exe</code> or <code>wscript.exe</code>.</p>
<p>Following is an example of Process Explorer displaying an obviously malicious PowerShell script running on the system:</p>
<p><img src="../img/procexp_powershell.png" alt=""></p>
<p>Hovering with the cursor over the process name shows the command-line arguments where we can clearly see the script is attempting to download and execute some additional code. Notice also the use of variating lower and upper case, such as &quot;doWnLoAdfile&quot;: this is a very basic trick attackers use to evade equally basic detection patterns by security software.</p>
<h3 id="3-look-for-running-dlls">3. Look for running DLLs</h3>
<p>Malware sometimes also comes in the form of a <a href="https://support.microsoft.com/en-us/help/815065/what-is-a-dll" target="_blank">Dynamic Link Library (DLL)</a> which, opposite to a standalone application (in other words, a <code>.exe</code> file), needs to be launched by a loader. Windows provides a few programs to launch DLLs, commonly <code>regsvr32.exe</code> and <code>rundll32.exe</code>, which are signed by Microsoft.</p>
<p>Look out for any of those processes running, and try to determine what DLL file they are executing. For example, in the screenshot below, we can see an infected Windows system running a malicious DLL file located under <code>C:\Users\&lt;Username&gt;\AppData\</code> using <code>regsvr32.exe</code>.</p>
<p><img src="../img/procexp_regsvr.png" alt=""></p>
<h3 id="4-look-for-processes-of-applications-that-should-be-visible">4. Look for processes of applications that should be visible</h3>
<p>Among the many techniques often used by attackers there is, for example, <a href="https://attack.mitre.org/techniques/T1093/" target="_blank">Process Hollowing</a>. Process Hollowing consists in launching a legitimate application (such as Internet Explorer or Google Chrome), emptying its memory and replacing it with malicious code, which will then be executed. This is normally done to hide the malicious code, make it appear as a legitimate application (which would then only be an empty shell), evade applications firewall and perhaps evade some other security products.</p>
<p>For exampe, if you see a running <code>iexplore.exe</code> process, when there is obviously no open Internet Explorer window, you should consider this a worrying sign.</p>
<p><img src="../img/procexp_iexplore.png" alt=""></p>
<h3 id="optional-5-looking-up-programs-on-virustotal">Optional: 5. Looking up programs on VirusTotal</h3>
<p>Similarly to <a href="autoruns.html">Autoruns</a> section, Process Explorer also offers to look-up running processes on VirusTotal by searching the cryptographic hash of the respective executable files. This can be enabled by clicking <em>Options</em> &gt; <em>VirusTotal.com</em> and enabling <em>Check VirusTotal.com</em>.</p>
<p><img src="../img/procexp3.png" alt=""></p>
<p><strong>Please note:</strong> the same considerations and warnings explained in the <a href="autoruns.html">previous section</a> apply here too. Make sure to read them before proceeding.</p>
<h2 id="crowdinspect">CrowdInspect</h2>
<p><a href="https://www.crowdstrike.com/resources/crowdinspect/" target="_blank">CrowdInspect</a> is a tool produced by the American security company CrowdStrike. CrowdInspect is very similar to Process Explorer, but it has some advantages. Firstly, the information presented tends to be more compact. Secondly, it does not only show currently live processes, but it also can show processes that have terminated since it launch (that you might have perhaps missed because they executed too quickly). Lastly, it performs a number more checks that Process Explorer currently does not support.</p>
<p><img src="../img/crowdinspect.png" alt=""></p>
<h3 id="check-for-any-process-injections">Check for any process injections</h3>
<p>Probably the most interesting feature CrowdInspect introduces, is the ability to identify any <a href="https://attack.mitre.org/techniques/T1055/" target="_blank">injected processes</a>. Process injection is a category of techniques whose objective is run malicious code within the context of a separate, generally legitimate, application (such as <code>explorer.exe</code>). Process injection is often used by malware authors in order to obtain additional privileges on the system or, for example, to evade detection.</p>
<p>CrowdInspect will alert you of any injected processes by displaying a visible red dot under the &quot;<em>Inject</em>&quot; column. Injected processes are generally a very good indicator that there might be an active infection on the tested computer.</p>
<p><img src="../img/crowdinspect_injection.png" alt=""></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="autoruns.html" class="navigation navigation-prev " aria-label="Previous page: Review Programs Launching at Startup">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="network.html" class="navigation navigation-next " aria-label="Next page: Review Network Connections">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Review Running Processes","level":"1.4.2","depth":2,"next":{"title":"Review Network Connections","level":"1.4.3","depth":2,"path":"windows/network.md","ref":"windows/network.md","articles":[]},"previous":{"title":"Review Programs Launching at Startup","level":"1.4.1","depth":2,"path":"windows/autoruns.md","ref":"windows/autoruns.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"windows/processes.md","mtime":"2020-01-13T19:36:47.181Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-04-28T15:31:36.758Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

