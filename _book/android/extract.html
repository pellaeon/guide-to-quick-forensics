
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Extract Data for Further Analysis Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="stalkerware.html" />
    
    
    <link rel="prev" href="root.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../preparations.html">
            
                <a href="../preparations.html">
            
                    
                    Preparations
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../safety.html">
            
                <a href="../safety.html">
            
                    
                    Safety
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../trust.html">
            
                <a href="../trust.html">
            
                    
                    Trust
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../backup.html">
            
                <a href="../backup.html">
            
                    
                    Backup
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../methodology.html">
            
                <a href="../methodology.html">
            
                    
                    Methodology
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../windows.html">
            
                <a href="../windows.html">
            
                    
                    Checking Windows Computers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../windows/autoruns.html">
            
                <a href="../windows/autoruns.html">
            
                    
                    Review Programs Launching at Startup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../windows/processes.html">
            
                <a href="../windows/processes.html">
            
                    
                    Review Running Processes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../windows/network.html">
            
                <a href="../windows/network.html">
            
                    
                    Review Network Connections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../windows/extract.html">
            
                <a href="../windows/extract.html">
            
                    
                    Extract Data for Further Analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../mac.html">
            
                <a href="../mac.html">
            
                    
                    Checking Mac Computers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../mac/autoruns.html">
            
                <a href="../mac/autoruns.html">
            
                    
                    Review Programs Launching at Startup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../mac/processes.html">
            
                <a href="../mac/processes.html">
            
                    
                    Review Running Processes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../mac/kernel.html">
            
                <a href="../mac/kernel.html">
            
                    
                    Review Kernel Extensions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../mac/network.html">
            
                <a href="../mac/network.html">
            
                    
                    Review Network Connections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../mac/extract.html">
            
                <a href="../mac/extract.html">
            
                    
                    Extract Data for Further Analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../smartphones.html">
            
                <a href="../smartphones.html">
            
                    
                    Checking Smartphones
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../smartphones/linkeddevices.html">
            
                <a href="../smartphones/linkeddevices.html">
            
                    
                    Check Devices Linked to Chat Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../smartphones/network.html">
            
                <a href="../smartphones/network.html">
            
                    
                    Monitor Network Traffic
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../android.html">
            
                <a href="../android.html">
            
                    
                    Checking Android Devices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="applications.html">
            
                <a href="applications.html">
            
                    
                    Review installed Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="root.html">
            
                <a href="root.html">
            
                    
                    Check if the Phone is Rooted
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.7.3" data-path="extract.html">
            
                <a href="extract.html">
            
                    
                    Extract Data for Further Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="stalkerware.html">
            
                <a href="stalkerware.html">
            
                    
                    Optional : Check for Indicators of Stalkerware Installation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../ios.html">
            
                <a href="../ios.html">
            
                    
                    Checking iOS Devices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="../ios/icloud.html">
            
                <a href="../ios/icloud.html">
            
                    
                    Review iCloud Accounts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="../ios/mdm.html">
            
                <a href="../ios/mdm.html">
            
                    
                    Check for Mobile Device Management Profiles
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.3" data-path="../ios/jailbreaks.html">
            
                <a href="../ios/jailbreaks.html">
            
                    
                    Check for Jailbreaks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="../ios/extract.html">
            
                <a href="../ios/extract.html">
            
                    
                    Extract Data for Further Analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../remote.html">
            
                <a href="../remote.html">
            
                    
                    Checking Devices Remotely
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../remote/mac.html">
            
                <a href="../remote/mac.html">
            
                    
                    Mac Computers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../license-credits.html">
            
                <a href="../license-credits.html">
            
                    
                    License and Credits
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Extract Data for Further Analysis</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="extract-data-for-further-analysis">Extract data for Further Analysis</h1>
<p>To extract data for analysis, you can use <a href="https://github.com/botherder/snoopdroid" target="_blank">Snoopdroid</a> developed by Claudio Guarnieri. This tool allows to extract the list of android applications installed on the phone, and check on <a href="https://www.virustotal.com/" target="_blank">VirusTotal</a> and <a href="https://koodous.com/" target="_blank">Koodous</a> if they are known to be malicious.</p>
<h2 id="installation-on-linux">Installation on Linux</h2>
<p>In order to run Snoopdroid on Debian you will need to install the following dependencies:</p>
<pre><code>apt install python3 python3-pip python3-dev build-essential libssl-dev libffi-dev swig android-sdk-platform-tools
</code></pre><p>Make sure to generate your adb keys with:</p>
<pre><code>adb keygen ~/.android/adbkey
</code></pre><p>You can then install Snoopdroid with pip3:</p>
<pre><code>pip3 install rsa
pip3 install snoopdroid
</code></pre><h2 id="installation-on-mac-osx">Installation on Mac OSX</h2>
<p>Running Snoopdroid on Mac requires Xcode and <a href="https://brew.sh/" target="_blank">homebrew</a> to be installed.</p>
<p>In order to install adb and other dependencies use:</p>
<pre><code>brew install openssl swig libusb python3
brew install homebrew/cask/android-platform-tools
</code></pre><p>Make sure to generate your adb keys:</p>
<pre><code>mkdir $HOME/.android
adb keygen $HOME/.android/adbkey
adb pubkey $HOME/.android/adbkey &gt; $HOME/.android/adbkey.pub
</code></pre><p>You can now install Snoopdroid with pip3:</p>
<pre><code>pip3 install rsa
pip3 install snoopdroid
</code></pre><h2 id="set-up-adb-usb-debugging">Set-up ADB USB Debugging</h2>
<p>To use Snoopdroid, you need to enable USB debugging in the developers options. Here are the instructions to do so from the <a href="https://developer.android.com/studio/debug/dev-options#enable" target="_blank">official Android documentation</a> :</p>
<ul>
<li>On Android 4.1 and lower, the Developer options screen is available by default.</li>
<li>On Android 4.2 and higher, you must enable this screen as follows:<ul>
<li>Open the Settings app.</li>
<li>(Only on Android 8.0 or higher) Select System.</li>
<li>Scroll to the bottom and select About phone.</li>
<li>Scroll to the bottom and tap Build number 7 times.</li>
<li>Return to the previous screen to find Developer options near the bottom.</li>
</ul>
</li>
</ul>
<p>At the top of the Developer options screen, you can toggle the options on and off (figure 1). You probably want to keep this on. When off, most options are disabled except those that don&apos;t require communication between the device and your development computer.</p>
<p>Next, you should scroll down a little and enable USB debugging. This allows Android Studio and other SDK tools to recognize your device when connected via USB, so you can use the debugger and other tools.</p>
<p>To test that the USB connection is working, you can use the ADB shell, just run <code>adb devices</code> and check if you see a connected device. for instance :</p>
<pre><code>&gt; adb devices
List of devices attached
RF2F722NU0C    device
</code></pre><p>You can test that the access is working by running <code>adb shell</code>, the phone will then ask you to confirm that the device is allowed to debug the phone.</p>
<p>Before using snoopdroid, you need to kill the adb service you just used with <code>adb kill-server</code>.</p>
<h2 id="run-snoopdroid">Run Snoopdroid</h2>
<p>You can now launch Snoopdroid simply with <code>snoopdroid</code>. At each run, Snoopdroid will generate a new acquisition folder containing all the extracted APKs in the current working directory. You can change the base folder using:</p>
<pre><code>snoopdroid --storage /path/to/folder
</code></pre><p>Optionally, you can decide to enable lookups of the SHA256 hash of all the extracted APKs on VirusTotal and/or Koodous. While these lookups do not provide any conclusive assessment on all of the extracted APKs, they might highlight any known malicious ones.</p>
<pre><code>snoopdroid --virustotal
snoopdroid --koodous
</code></pre><p>Or, to launch all available lookups:</p>
<pre><code>snoopdroid --all-checks
</code></pre><p><img src="../img/snoopdroid.png" alt="image"></p>
<p>You will then see a folder containing a <code>packages.json</code> file with the list of packages installed on the phone and a folder named <code>apks</code> containing the APK files.</p>
<p>Extract of a <code>packages.json</code> file :</p>
<pre><code>    {
        &quot;name&quot;: &quot;com.android.cts.priv.ctsshim&quot;,
        &quot;files&quot;: [
            {
                &quot;path&quot;: &quot;/system/priv-app/CtsShimPrivPrebuilt/CtsShimPrivPrebuilt.apk&quot;,
                &quot;stored_path&quot;: &quot;/home/user/snoopdroid/2019-08-13T154540/apks/com.android.cts.priv.ctsshim.apk&quot;,
                &quot;sha256&quot;: &quot;1b930afd81f765a3366f21e57cfcfdefc867fda93e859b136aeef27ecfd9cb0c&quot;
            }
        ]
    },
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="root.html" class="navigation navigation-prev " aria-label="Previous page: Check if the Phone is Rooted">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="stalkerware.html" class="navigation navigation-next " aria-label="Next page: Optional : Check for Indicators of Stalkerware Installation">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Extract Data for Further Analysis","level":"1.7.3","depth":2,"next":{"title":"Optional : Check for Indicators of Stalkerware Installation","level":"1.7.4","depth":2,"path":"android/stalkerware.md","ref":"android/stalkerware.md","articles":[]},"previous":{"title":"Check if the Phone is Rooted","level":"1.7.2","depth":2,"path":"android/root.md","ref":"android/root.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"android/extract.md","mtime":"2020-01-13T19:36:47.077Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-04-28T15:31:36.758Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

