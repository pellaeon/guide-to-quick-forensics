
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Check for Jailbreaks Â· GitBook</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="extract.html" />
    
    
    <link rel="prev" href="mdm.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../preparations.html">
            
                <a href="../preparations.html">
            
                    
                    Preparations
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../safety.html">
            
                <a href="../safety.html">
            
                    
                    Safety
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../trust.html">
            
                <a href="../trust.html">
            
                    
                    Trust
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../backup.html">
            
                <a href="../backup.html">
            
                    
                    Backup
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../methodology.html">
            
                <a href="../methodology.html">
            
                    
                    Methodology
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="../windows.html">
            
                <a href="../windows.html">
            
                    
                    Checking Windows Computers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../windows/autoruns.html">
            
                <a href="../windows/autoruns.html">
            
                    
                    Review Programs Launching at Startup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../windows/processes.html">
            
                <a href="../windows/processes.html">
            
                    
                    Review Running Processes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../windows/network.html">
            
                <a href="../windows/network.html">
            
                    
                    Review Network Connections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../windows/extract.html">
            
                <a href="../windows/extract.html">
            
                    
                    Extract Data for Further Analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="../mac.html">
            
                <a href="../mac.html">
            
                    
                    Checking Mac Computers
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../mac/autoruns.html">
            
                <a href="../mac/autoruns.html">
            
                    
                    Review Programs Launching at Startup
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../mac/processes.html">
            
                <a href="../mac/processes.html">
            
                    
                    Review Running Processes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../mac/kernel.html">
            
                <a href="../mac/kernel.html">
            
                    
                    Review Kernel Extensions
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../mac/network.html">
            
                <a href="../mac/network.html">
            
                    
                    Review Network Connections
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.5" data-path="../mac/extract.html">
            
                <a href="../mac/extract.html">
            
                    
                    Extract Data for Further Analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../smartphones.html">
            
                <a href="../smartphones.html">
            
                    
                    Checking Smartphones
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.6.1" data-path="../smartphones/linkeddevices.html">
            
                <a href="../smartphones/linkeddevices.html">
            
                    
                    Check Devices Linked to Chat Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.6.2" data-path="../smartphones/network.html">
            
                <a href="../smartphones/network.html">
            
                    
                    Monitor Network Traffic
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.7" data-path="../android.html">
            
                <a href="../android.html">
            
                    
                    Checking Android Devices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.7.1" data-path="../android/applications.html">
            
                <a href="../android/applications.html">
            
                    
                    Review installed Applications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.2" data-path="../android/root.html">
            
                <a href="../android/root.html">
            
                    
                    Check if the Phone is Rooted
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.3" data-path="../android/extract.html">
            
                <a href="../android/extract.html">
            
                    
                    Extract Data for Further Analysis
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.7.4" data-path="../android/stalkerware.html">
            
                <a href="../android/stalkerware.html">
            
                    
                    Optional : Check for Indicators of Stalkerware Installation
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.8" data-path="../ios.html">
            
                <a href="../ios.html">
            
                    
                    Checking iOS Devices
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.8.1" data-path="icloud.html">
            
                <a href="icloud.html">
            
                    
                    Review iCloud Accounts
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.2" data-path="mdm.html">
            
                <a href="mdm.html">
            
                    
                    Check for Mobile Device Management Profiles
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.8.3" data-path="jailbreaks.html">
            
                <a href="jailbreaks.html">
            
                    
                    Check for Jailbreaks
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.8.4" data-path="extract.html">
            
                <a href="extract.html">
            
                    
                    Extract Data for Further Analysis
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.9" data-path="../remote.html">
            
                <a href="../remote.html">
            
                    
                    Checking Devices Remotely
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.9.1" data-path="../remote/mac.html">
            
                <a href="../remote/mac.html">
            
                    
                    Mac Computers
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.10" data-path="../license-credits.html">
            
                <a href="../license-credits.html">
            
                    
                    License and Credits
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Check for Jailbreaks</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="check-for-jailbreaks">Check for Jailbreaks</h1>
<p>In order to install spyware on an iOS device, attackers need to exploit vulnerabilities in the operating system. Apple has made this task significantly harder over the years, and such exploits have become more difficult and more expensive to produce. Remote Exploits (attacking, for example, <a href="https://www.engadget.com/2019/05/13/whatsapp-call-exploit-allowed-spyware" target="_blank">WhatsApp</a>, iMessage or Safari) are particularly rare and costly, and are only accessible to resourceful attackers, typically governments. In the case that an iOS device was indeed compromised with a private, commercial-grade sophisticated exploit, it is likely the case that the only check you can perform is of the outgoing <a href="../network.md">network traffic</a>.</p>
<p>Jailbreaks are exploits for mobile devices, in this case iPhones and iPads, that are typically installed manually on the phone and which disable certain security features of iOS. New <a href="http://theiphonewiki.com/wiki/jailbreak" target="_blank">jailbreaks are regularly made available to the public</a> and attackers might use them if the target devices are of the right model and version of iOS. At the time of writing, there are public jailbreaks available for iOS up to version 12.4.</p>
<p>Because regular users typically would not (and should not) install jailbreaks on their iPhones and iPads, if the device you are testing shows appears jailbroken it is a very credible sign of a potential compromise. Following are some of the traces that might be left behind by a public jailbreak.</p>
<h2 id="look-for-any-jailbreak-related-applications-icons">Look for any jailbreak-related applications icons</h2>
<p>During the process of jailbreaking the phone, several applications are often installed, either to jailbreak the phone (like <a href="https://github.com/pwn20wndstuff/Undecimus" target="_blank">unc0ver</a> or <a href="https://chimera.sh/" target="_blank">Chimera</a>) or to install applications (such as <a href="https://cydia.saurik.com/" target="_blank">Cydia</a> or <a href="https://getsileo.app/" target="_blank">Sileo</a>). A first step to identify a jailbroken iPhone is to check for one of these apps on the phone :</p>
<table>
<thead>
<tr>
<th>App</th>
<th>Logo</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cydia</td>
<td><img src="../img/cydia.png" alt="image"></td>
</tr>
<tr>
<td>Sileo</td>
<td><img src="../img/sileo.png" alt="image"></td>
</tr>
<tr>
<td>unc0ver</td>
<td><img src="../img/unc0ver.png" alt="image"></td>
</tr>
<tr>
<td>Chrimera</td>
<td><img src="../img/chimera.png" alt="image"></td>
</tr>
<tr>
<td>Electra</td>
<td><img src="../img/electra.png" alt="image"></td>
</tr>
</tbody>
</table>
<h2 id="scan-the-phone-for-open-ports">Scan the phone for open ports</h2>
<p>Many jailbreak tools install a ssh server by default during the operation. It is then possible to detect if the server is running by checking open ports on the iPhone from another computer on the same network.</p>
<p>To do that, you first need to get the iPhone IP address, go Settings &gt; Wifi &gt; Your network, and get the value in the &quot;IP Address&quot; field (something like 192.168.0.1).</p>
<p>From another computer on the same network, you need to use a port scanner such as <a href="https://nmap.org/" target="_blank">nmap</a> and scan the ports on the iPhone with it. For instance with nmap through command-line :</p>
<pre><code># nmap 192.168.186.196
Starting Nmap 7.70 ( https://nmap.org ) at 2019-11-07 00:07 CET
Nmap scan report for iPhoneRobert.lan (192.168.186.196)
Host is up (0.0041s latency).
Not shown: 998 closed ports
PORT      STATE SERVICE
22/tcp    open  ssh
62078/tcp open  iphone-sync

Nmap done: 1 IP address (1 host up) scanned in 41.18 seconds
</code></pre><p>In this scan, we see that ssh is running on port 22 (its default port), so it means that the iphone is jailbroken.</p>
<h2 id="try-to-mount-the-full-filesystem">Try to mount the full filesystem</h2>
<p>In many cases, jailbreaking the device will also install by default the AFC2 service that allows to mount the root filesystem from an external computer connected through USB. You can test if the root filesystem of the iPhone can be mounted by using the <a href="https://github.com/libimobiledevice/ifuse" target="_blank">ifuse</a> tool.</p>
<p>You first need to download the source code and install it on your Linux or MacOSX system as explained in <a href="https://github.com/libimobiledevice/ifuse/wiki" target="_blank">this page</a>.</p>
<p>Once installed, you have to accept that the phone trust the computer and can just run <code>ifuse --root FOLDER</code>.</p>
<p>If the phone is jailbroken with the AFC2 service running, the root filesystem will be mounted directly to the given folder :</p>
<pre><code>&gt; ifuse --root mount/
&gt; ls mount
Applications  boot   dev        etc  lib      mnt      sbin    tmp   usr
bin           cores  Developer  jb   Library  private  System  User  var
</code></pre><p>If the phone is not jailbroken or if AFC2 is not running on it, you will see the following error message :</p>
<pre><code>&gt; ifuse --root mount/
Failed to start AFC service &apos;com.apple.afc2&apos; on the device.
This service enables access to the root filesystem of your device.
Your device needs to be jailbroken and have the AFC2 service installed.
</code></pre>
                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="mdm.html" class="navigation navigation-prev " aria-label="Previous page: Check for Mobile Device Management Profiles">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="extract.html" class="navigation navigation-next " aria-label="Next page: Extract Data for Further Analysis">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Check for Jailbreaks","level":"1.8.3","depth":2,"next":{"title":"Extract Data for Further Analysis","level":"1.8.4","depth":2,"path":"ios/extract.md","ref":"ios/extract.md","articles":[]},"previous":{"title":"Check for Mobile Device Management Profiles","level":"1.8.2","depth":2,"path":"ios/mdm.md","ref":"ios/mdm.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"*","theme":"default","variables":{},"plugins":[],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"ios/jailbreaks.md","mtime":"2020-01-13T19:36:47.173Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-04-28T15:31:36.758Z"},"basePath":"..","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

